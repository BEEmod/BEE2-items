"Conditions"
	{
	"Condition"
		{
		"instance"	"<ITEM_TS_BRIDGE_PANEL>"
		"Result"
			{
			"SetInstVar" "$skin %BRIDGE_SKIN%"
			}
		"Condition"
			{
			// Force the bridge on if no inputs are provided.
			"InstVar" "$conn_count_b = 0"
			"Result"
				{
				"SetInstVar" "$start_enabled 1"
				}
			}
		"Condition"
			{
			"InstVar"   "$conn_count_a = 0"
			"Result" // The panel is immoveable, just need to directly control the bridge.
				{
				"ChangeInstance" "<ITEM_TS_BRIDGE_PANEL:bee2_static_common>"
				"Switch"
					{
					"Flag" "instvar"
					"$animation ramp_30_deg_open"
						{
						"AddOverlay" "<ITEM_TS_BRIDGE_PANEL:bee2_static_30>"
						"SetInstVar" "$angle 30"
						"TemplateBrush" "BEE2_ANGLED_LIGHT_BRIDGE:flat"
						"CreatePanel"
							{
							"type" "angle_30"
							"thickness" "2"
							"bevel" "0"
							"Offset" "0 0 0"
							"Keys"
								{
								"classname" "func_detail"
								}
							}
						}
					"$animation ramp_45_deg_open"
						{
						"AddOverlay" "<ITEM_TS_BRIDGE_PANEL:bee2_static_45>"
						"SetInstVar" "$angle 45"
						"TemplateBrush" "BEE2_ANGLED_LIGHT_BRIDGE:flat"
						"CreatePanel"
							{
							"type" "angle_45"
							"thickness" "2"
							"bevel" "0"
							"Offset" "0 0 0"
							"Keys"
								{
								"classname" "func_detail"
								}
							}
						}
					"$animation ramp_60_deg_open"
						{
						"AddOverlay" "<ITEM_TS_BRIDGE_PANEL:bee2_static_60>"
						"SetInstVar" "$angle 60"
						"TemplateBrush" "BEE2_ANGLED_LIGHT_BRIDGE:flat"
						"CreatePanel"
							{
							"type" "angle_60"
							"thickness" "2"
							"bevel" "0"
							"Offset" "0 0 0"
							"Keys"
								{
								"classname" "func_detail"
								}
							}
						}
					"$animation ramp_90_deg_open"
						{
						"AddOverlay" "<ITEM_TS_BRIDGE_PANEL:bee2_static_90>"
						"SetInstVar" "$angle 90"

						// Create the upright panel.
						"TemplateBrush" "BEE2_ANGLED_LIGHT_BRIDGE:90"
						// Then make that a panel.
						"CreatePanel"
							{
							"normal" "-1 0 0"
							"pos1" "-64 48 16"
							"pos2" "-64 -48 112"

							"type" "normal"
							"thickness" "2"
							"bevel" "0"
							"Offset" "0 0 0"
							"keys"
								{
								"classname" "func_detail"
								}
							}
						}
					}
				"Condition"
					{
					"InstVar" "$start_reversed 1"
					"Result"
						{
						"AddOverlay" "<ITEM_TS_BRIDGE_PANEL:bee2_static_vert>"
						}
					"Else"
						{
						"AddOverlay" "<ITEM_TS_BRIDGE_PANEL:bee2_static_horiz>"
						}
					}
				"RemoveInstVar" "$angle"
				}
			// Dynamic panel.
			"Else"
				{
				"ChangeInstance" "<ITEM_TS_BRIDGE_PANEL:bee2_common_dynamic>"
				"TemplateBrush" "BEE2_ANGLED_LIGHT_BRIDGE:flat"
				"CreatePanel"
					{
					"type" "normal"
					"thickness" "2"
					"bevel" "1"
					"Offset" "0 0 0"

					"keys"
						{
						"classname" "func_brush"
						"drawinfastreflection" "1"
						"parent_attachment_point" "panel_attach"
						}
					"localkeys"
						{
						"parentname" "model_arms"
						"targetname" "pan_top"
						}
					}
				"Condition"
					{
					"InstVar" "$start_deployed 0"
					"Result"
						{
						"AddOverlay" "instances/BEE2/clean/items/panel_bridge/spawnclose.vmf"
						}
					}
				"Condition"
					{
					"InstVar" "$start_reversed 1"
					"Result"
						{
						"AddOverlay" "<ITEM_TS_BRIDGE_PANEL:bee2_dynamic_vert>"
						}
					"Else"
						{
						"AddOverlay" "<ITEM_TS_BRIDGE_PANEL:bee2_dynamic_horiz>"
						}
					}
				}
			}
		}
	// Pre-rotate the static instance for the bridge around the panel hinge.
	"Condition"
		{
		"instance" "<ITEM_TS_BRIDGE_PANEL:bee2_static_vert, bee2_static_horiz>"
		"Result"
			{
			"RotateInst"
				{
				"axis" "0 -1 0"
				"angle" "$angle"
				"around" "-64 0 -64"
				}
			}
		}
	}
