"Conditions"
	{
	"Condition"
		{
		"instance" "<ITEM_DRAW_BRIDGE>"
		
		"Result"
			{
			// Can't use editor white/black information with the angled panel class, so sample the tiles below
			"ReadSurfType"
				{
				"Pos"  "-48 -48 0"
				"Pos2" "-16 48 0"
				"ResultVar" "$portalable"
				}
			"SetTiles" // Underneath the panel, make it black.
				{
				"Tile" "BB"
				"Tile" "BB"
				"Tile" "BB"
				"Tile" "BB"
				}
			}

		// Static
		"Condition"
			{
			"instvar"  "connectioncount 0"
			"Result"
				{
				// Swap the existing instance for static panels
				// TODO: Should probably convert this to a template
				"ChangeInstance" "<ITEM_DRAW_BRIDGE:bee2_pan_$portalable>"
				}
			"Condition"
				{
				"instvar" "start_enabled 1"
				"Result"
					{
					"Suffix" "static_up"
					"AddOverlay"
						{
						"File" "<ITEM_DRAW_BRIDGE:bee2_static_up>"
						}
					}
				"Else"
					{
					"Suffix" "static_down"
					"AddOverlay"
						{
						"File" "<ITEM_DRAW_BRIDGE:bee2_static_down>"
						}
					}
				}
			}
			
		// Dynamic
		"Condition"
			{
			"instvar" "connectioncount > 0"
			"Result"
				{
				// Add overlay for dynamic panels
				"AddOverlay" "<ITEM_DRAW_BRIDGE:bee2_pan_$portalable>"
				"GenRotatingEnt"
					{
					"Classname"  "func_door_rotating"
					"Axis"       "Y"
					"Reversed"   "1"
					
					"Name"       "motor_wheel"
					"Pos"        "-29 39 -38"
					"Flags"      "0"
					"Keys"
						{
						"maxspeed"    "900"
						"distance"    "180"
						"wait"        "-1"
						"forceclosed" "1"
						}
					}
				}
			"Condition"
				{
				// Check the block above the drawbridge is present,
				// to decide which rope anchor to use..
				"PosIsSolid"
					{
					"Pos1"   "-112 -48 0"
					"Pos2"   "-80 48 0"
					"Dir"    "0 0 1"
					"Type"   "any"
					"Mode"   "or"
					}
				"Result"
					{
					"AddOverlay"
						{
						"file" "<ITEM_DRAW_BRIDGE:bee2_pan_rope_wall>"
						}
					}
				"Else"
					{
					"AddOverlay"
						{
						"file" "<ITEM_DRAW_BRIDGE:bee2_pan_rope_floor>"
						}
					"GenRotatingEnt"
						{
						"Classname"  "func_door_rotating"
						"Axis"       "Y"
						"Reversed"   "0"
						
						"Name"       "motor_wheel_ropes"
						"Pos"        "-86 0 -95"
						"Flags"      "0"
						"Keys"
							{
							"maxspeed"    "360"
							"distance"    "105"
							"wait"        "-1"
							"forceclosed" "1"
							}
						}
					}
				}
			}
		}
	}
