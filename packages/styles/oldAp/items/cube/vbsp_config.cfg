"DropperItems"
	{
	"Dropper"
		{
		"ID"        "VITAL_APPARATUS_VENT"
		"ItemID"    "<ITEM_DROPPER_CUBE:0>"
		// The dropper is opaque, so we spawn right on top of the
		// lid
		"Cube_Pos"  "0 0 33"
		"cube_Ang"  "0 180 180" // Yaw to point in the handle direction, roll to face upright.
		
		"OutStartDrop"  "instance:spawn_man;OnUser1"
		"OutFinishDrop" "instance:cube_dropper_close_trigger;OnEndTouchAll"
		"InputRespawn"  "instance:cube_dropper_gate_relay;Trigger"
		
		// Instance for painting cubes with Repulsion Gel as they fall out.
		"BluePaintInst"  "instances/BEE2/50s/items/cube/painter_blue.vmf"

		"clip" "$clip_temp"
		// A 'path' the cube takes, which it carves out of the dropper clip.
		"clip_point" "0 0 -192"
		"clip_point" "0 0 96"
		}
	
	// These IDs are specially handled and set.
	"Cube"
		{
		"ID"          "VALVE_CUBE_STANDARD"
		"HasName"     "Standard"
		"CubeType"    "ANTIQUE"
		"ItemID"      "<ITEM_CUBE:0>"
		"clip_carve"  "BEE2_CUBE_SHAPE:standard" // Still the same size as modern.
		"Offset"      "20"
		
		"ModelColor"  "models/BEE2/cube_color/retro_standard.mdl"
		}
	"Cube"
		{
		"ID"          "VALVE_CUBE_COMPANION"
		"HasName"     "Companion"
		"CubeType"    "ANTIQUE" // Needs to be this for gel skins etc.
		"isCompanion" "1" // But treat as companion for voicelines.
		"ItemID"      "<ITEM_CUBE:1>"
		"clip_carve"  "BEE2_CUBE_SHAPE:standard"
		"Offset"      "20"
		
		"Model"       "models/bee2/props_ingame/retro_companion.mdl"		
		"ModelColor"  "models/BEE2/cube_color/retro_companion.mdl"
		}
	"Cube"
		{
		"ID"         "VALVE_CUBE_REFLECTION"
		"HasName"    "Reflect"
		"CubeType"   "REFLECTION"
		"ItemID"     "<ITEM_CUBE:2>"
		"clip_carve" "BEE2_CUBE_SHAPE:reflect"
		"Offset"     "20"
		
		"Model"       "models/bee2/rosemary/underground_reflecto_cube.mdl"
		"ModelColor"  "models/bee2/rosemary/underground_reflecto_cube_color.mdl"
		}
	"Cube"
		{
		"ID"         "VALVE_CUBE_SPHERE"
		"HasName"    "Sphere"
		"CubeType"   "SPHERE"
		"ItemID"     "<ITEM_CUBE:3>"
		"clip_carve" "BEE2_CUBE_SHAPE:edgeless"
		"Offset"     "20"
		
		"Model"      "models/ball_underground_228/ball_underground_228.mdl"
		// Setup to be tintable.
		"ModelColor" "models/ball_underground_228/ball_underground_228.mdl"
		}
	"Cube"
		{
		"ID"         "VALVE_CUBE_FRANKEN"
		"HasName"    "Franken"
		"CubeType"   "FRANKEN"
		"ItemID"     "<ITEM_CUBE:4>"
		"BaseTint"   "240 225 200"
		"clip_carve" "BEE2_CUBE_SHAPE:standard"
		}
	}

"Conditions"
	{
	"Condition"
		{
		"Priority"	"50"
		"instance"	"<ITEM_DROPPER_CUBE>"
		"Condition"
			{
			// If they're all the same, just use a single brush.
			"PosIsSolid"
				{
				"Pos1"   "-48 -48 0"
				"Pos2"   "48 48 0"
				"Dir"    "0 0 1"
				"Type"   "same"
				"SetVar" "$tile_color"
				}
			"Result"
				{
				"TemplateBrush" 
					{
					"ID" "BEE2_CUBE_DROPPER_RETRO_CAP:single"
					"ColorVar" "$tile_color"
					}
				}
			"Else"
				{
				"TemplateBrush" "BEE2_CUBE_DROPPER_RETRO_CAP:multi"				
				}
			}
		"Result"
			{
			"RemoveFixup" "$tile_color"
			"addOverlay"  "instances/BEE2/50s/items/cube/dropper_hole.vmf"
			}
		"Condition"
			{
			"$item_fall_straight_down" "0"
			"Result"
				{
				// Loose clips - collide with the door, remove internal clips.
				"addOverlay" "instances/BEE2/50s/items/cube/dropper_door_clip.vmf"
				"$clip_temp" ""
				}
			"Else"
				{
				"$clip_temp" "BEE2_CUBE_DROPPER_50S_CLIP"
				}
			}
		"Condition"
			{
			"$disable_autodrop" "0"
			"Result"
				{
				"GlobalInput"
					{
					"Name"      "@relay_spawn_on_entrance"
					"Target"    "spawn_man"
					"Input"     "SetStateATrue"
					}
				}
			}
		
		// Add signs indicating different cube types.
		"Result"
			{
			"SetInstVar" "$drp_skin -1"
			}
		"Switch"
			{
			"Test" "CubeType"
			"<companion>"
				{
				"SetInstVar" "$drp_skin 0"
				}
			"<reflect>"
				{
				"SetInstVar" "$drp_skin 1"
				}
			"<sphere>"  // Also bumbleballs, etc.
				{
				"SetInstVar" "$drp_skin 2"
				}
			}
		"Condition"
			{
			"InstVar" "$drp_skin != -1"
			"Result"
				{
				// Use the necessary model.
				"CreateEntity"
					{
					"keys"
						{
						"classname" "comp_kv_setter"
						"mode" "kv"
						"kv_name" "model"
						"kv_value_global" "models/bee2/props_underground/dropper_altsigns.mdl"
						}
					"localkeys"
						{
						"target" "cube_dropper_model"
						}
					}
				}
			"Else"
				{
				// Use original.
				"SetInstVar" "$drp_skin 0"
				}
			}
			
		"Condition"
			{
			"DropperColor" "$tint_color"
			"Result"
				{
				"AddOverlay"
					{
					"File" "<ITEM_CUBE:bee2_colorizer_ring>"
					"Fixup"
						{
						"$color" "$tint_color"
						}
					}
				"RemoveFixup" "$tint_color"
				}
			}
		}
	}
